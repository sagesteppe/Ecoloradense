id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(61, 62) ~ 'West Maroon Trail',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) #%>%
View(trails)
View(trails1)
trails1 <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10, 38, 39) ~ 'Rustlers Gulch',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(61, 62) ~ 'West Maroon Trail',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) #%>%
View(trails1)
trails1 <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10, 38, 39) ~ 'Rustlers Gulch',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(61, 62) ~ 'West Maroon Trail',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) #%>%
trails1 <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10, 38, 39) ~ 'Rustlers Gulch',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(61, 62) ~ 'West Maroon Trail',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) %>%
ungroup() %>%
group_by(ID) %>%
summarize(geometry = st_union(geometry))
trails <- st_read('../data/hikingTrails/MtBaldyRoute.shp') %>%
st_make_valid()
trails1 <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10, 38, 39) ~ 'Rustlers Gulch',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(61, 62) ~ 'West Maroon Trail',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) %>%
ungroup() %>%
group_by(ID) %>%
summarize(geometry = st_union(geometry))
st_write(trails, '../data/hikingTrails/trails.shp', append = F)
trails1 <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10, 38, 39) ~ 'Rustlers Gulch',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(61, 62) ~ 'West Maroon Trail',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) %>%
ungroup() %>%
group_by(ID) %>%
summarize(geometry = st_union(geometry))
trails <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10, 38, 39) ~ 'Rustlers Gulch',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(61, 62) ~ 'West Maroon Trail',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) %>%
ungroup() %>%
group_by(ID) %>%
summarize(geometry = st_union(geometry))
st_write(trails, '../data/hikingTrails/trails.shp', append = F)
View(trails)
trails <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10) 'West Maroon Trail',
trails <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10) ~ 'West Maroon Trail',
id %in% c(35, 38, 39) ~ 'West Maroon Pass',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(61, 62) ~ 'Rustlers Gulch',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) %>%
ungroup() %>%
group_by(ID) %>%
summarize(geometry = st_union(geometry))
trails <- st_read('../data/hikingTrails/MtBaldyRoute.shp') %>%
st_make_valid()
trails <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44, 47) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10) ~ 'West Maroon Trail',
id %in% c(35, 38, 39) ~ 'West Maroon Pass',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(61, 62) ~ 'Rustlers Gulch',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) %>%
ungroup() %>%
group_by(ID) %>%
summarize(geometry = st_union(geometry))
st_write(trails, '../data/hikingTrails/trails.shp', append = F)
trails <- st_read('../data/hikingTrails/MtBaldyRoute.shp') %>%
st_make_valid()
trails <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10) ~ 'West Maroon Trail',
id %in% c(35, 38, 39) ~ 'West Maroon Pass',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(47, 61, 62) ~ 'Rustlers Gulch',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
mutate(ID = cur_group_id()) %>%
ungroup() %>%
group_by(ID) %>%
summarize(geometry = st_union(geometry))
st_write(trails, '../data/hikingTrails/trails.shp', append = F)
View(trails)
trails <- st_read('../data/hikingTrails/MtBaldyRoute.shp') %>%
st_make_valid()
trails <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10) ~ 'West Maroon Trail',
id %in% c(35, 38, 39) ~ 'West Maroon Pass',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(47, 61, 62) ~ 'Rustlers Gulch',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
summarize(geometry = st_union(geometry))
View(trails)
ggplot(trails) + geom_sf(aes(color = Trail))
trails <- st_transform(trails, 32613)
#' function to put a decent order to the ID's of random points based on trail positions
#' @param trails the trails network used to draw the random sample
#' @param points the output points
OrderRandomPtsIDS <- function(trails, points){
#' function to put a decent order to the ID's of random points based on trail positions
#' @param trails the trails network used to draw the random sample
#' @param points the output points
OrderRandomPtsIDS <- function(trails, points){
segments <- sf::st_segmentize(trails, dfMaxLength = 150)
vertices <- sf::st_cast(segments, 'POINT')
segments <- lwgeom::st_split(segments, vertices) |>
sf::st_collection_extract("LINESTRING") |>
unique() |>
dplyr::mutate(lineID = 1:n(), .before = geometry) |>
dplyr::mutate(lineID = dplyr::case_when(
lineID == min(lineID) ~ max(lineID),
lineID != min(lineID) ~ lineID - 1,
.default = as.numeric(lineID)
)) |>
arrange(lineID)
points_cp <- sf::st_transform(points, sf::st_crs(segments))
points_cp <- points_cp[ # determine which points are within the buffered areas
lengths(
sf::st_intersects(points_cp, sf::st_buffer(segments, dist = 45)
)
) > 0,
]
points_cp <- points_cp |>
dplyr::mutate(
Segment = st_nearest_feature(points_cp, segments),
Trail = trails$Trail[1], .before = geometry) |>
dplyr::arrange(Segment) |>
dplyr::mutate(TrailID = 1:n(), .before = geometry) |>
dplyr::select(-Segment)
return(points_cp)
}
trails_sp <- split(trails, f = trails$Trail)
obbies <- lapply(trails_sp, FUN = OrderRandomPtsIDS, points = thinned)
#' function to put a decent order to the ID's of random points based on trail positions
#' @param trails the trails network used to draw the random sample
#' @param points the output points
OrderRandomPtsIDS <- function(trails, points){
segments <- sf::st_segmentize(trails, dfMaxLength = 150)
vertices <- sf::st_cast(segments, 'POINT')
segments <- lwgeom::st_split(segments, vertices) |>
sf::st_collection_extract("LINESTRING") |>
unique() |>
dplyr::mutate(lineID = 1:n(), .before = geometry) |>
dplyr::mutate(lineID = dplyr::case_when(
lineID == min(lineID) ~ max(lineID),
lineID != min(lineID) ~ lineID - 1,
.default = as.numeric(lineID)
)) |>
arrange(lineID)
points_cp <- sf::st_transform(points, sf::st_crs(segments))
points_cp <- points_cp[ # determine which points are within the buffered areas
lengths(
sf::st_intersects(points_cp, sf::st_buffer(segments, dist = 45)
)
) > 0,
]
points_cp <- points_cp |>
dplyr::mutate(
Segment = st_nearest_feature(points_cp, segments),
Trail = trails$Trail[1], .before = geometry) |>
dplyr::arrange(Segment) |>
dplyr::mutate(TrailID = 1:n(), .before = geometry) |>
dplyr::select(-Segment)
return(points_cp)
}
trails_sp <- split(trails, f = trails$Trail)
obbies <- lapply(trails_sp, FUN = OrderRandomPtsIDS, points = thinned)
thinned <- spThin::thin( # no points found within 90m of each other !
loc.data = pts, lat.col = 'Latitude', long.col = 'Longitude', spec.col = 'Species',
thin.par = 0.128, reps = 100, write.files = FALSE, write.log.file = FALSE,
locs.thinned.list.return = TRUE)
trails_buf <- trails %>%
st_transform(32613) %>%
st_buffer(45)
pts <- st_sample(trails_buf, size = 500, type = 'random') %>%
st_as_sf() %>%
st_transform(4326) %>%
rename(geometry = x) %>%
mutate(
Longitude = unlist(map(.$geometry,1)),
Latitude = unlist(map(.$geometry,2)),
Species = 'Points'
)
thinned <- spThin::thin( # no points found within 90m of each other !
loc.data = pts, lat.col = 'Latitude', long.col = 'Longitude', spec.col = 'Species',
thin.par = 0.128, reps = 100, write.files = FALSE, write.log.file = FALSE,
locs.thinned.list.return = TRUE)
thinned <- thinned[[which.max(unlist(lapply(thinned, nrow)))]] %>%
st_as_sf(coords = c(x = 'Longitude', y = 'Latitude'), crs = 4326)
trails <- trails %>%
mutate(Trail = case_when(
id %in% c(1, 2, 3, 66) ~ 'Mt. Baldy',
id %in% c(4) ~ 'Cinnamon',
id %in% c(5) ~ 'Yule Pass',
id %in% c(6) ~ 'Gothic NRA',
id %in% c(8, 9, 11) ~ 'Frigid Air Pass',
id %in% c(19, 20) ~ 'Mt. Bellview',
id %in% c(21) ~ 'Treasury',
id %in% c(12, 13, 14, 15, 16, 17, 18, 52) ~ 'Hasley Pass',
id %in% c(23, 24, 25, 26, 44) ~ 'Virginia Basin',
id %in% c(7, 27, 29) ~ '401',
id %in% c(28, 47, 63, 65) ~ 'Bellview Mines',
id %in% c(36, 69) ~ 'Cassi Mines',
id %in% c(30, 33, 36, 37, 69, 71, 72) ~ 'Copper Lake/East Maroon Pass',
id %in% c(10) ~ 'West Maroon Trail',
id %in% c(35, 38, 39) ~ 'West Maroon Pass',
id %in% c(40, 41, 42, 43, 64, 68) ~ 'North Pole Basin',
id %in% c(45) ~ 'Red Rock',
id %in% c(48, 51) ~ '13043-Cassi Basin',
id %in% c(49, 50) ~ '13043 Ridge',
id %in% c(53) ~ 'Robinson Basin',
id %in% c(47, 61, 62) ~ 'Rustlers Gulch',
id %in% c(67) ~ 'Elko Park',
id %in% c(70) ~ 'Copper Creek',
id %in% c(46, 73, 74, 75, 77) ~ 'Avalanche Lake/Mt. Daly',
.default = as.character('blobby')
)
) %>%
group_by(Trail) %>%
summarize(geometry = st_union(geometry))
trails <- st_transform(trails, 32613)
trails_sp <- split(trails, f = trails$Trail)
obbies <- lapply(trails_sp, FUN = OrderRandomPtsIDS, points = thinned)
View(obbies)
View(obbies)
View(obbies)
obbies <- lapply(trails_sp, FUN = OrderRandomPtsIDS, points = thinned) |>
bind_rows()
obbies <- lapply(trails_sp, FUN = OrderRandomPtsIDS, points = thinned) |>
bind_rows() |>
mutate(UID = 1:n())
obbies <- lapply(trails_sp, FUN = OrderRandomPtsIDS, points = thinned) |>
bind_rows() |>
mutate(UID = 1:n(), .before = geometry)
View(obbies)
st_write(obbies, '../data/GroundTruthPts/Iteration1.shp', append = TRUE)
st_write(obbies, '../data/GroundTruthPts/Iteration1.shp', append = FALSE)
